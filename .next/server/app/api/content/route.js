"use strict";(()=>{var e={};e.id=170,e.ids=[170],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9623:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>g,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{GET:()=>l,POST:()=>p});var s=r(9303),o=r(8716),a=r(670),i=r(7070),u=r(4184),c=r(1150);async function l(e){try{await (0,u.Z)();let{searchParams:t}=new URL(e.url),r=t.get("type"),n=t.get("category"),s=t.get("language"),o=t.get("search"),a={};r&&"all"!==r&&(a.type=r),n&&(a.category=n),s&&(a.language=s),o&&(a.$or=[{title:{$regex:o,$options:"i"}},{tags:{$in:[RegExp(o,"i")]}}]);let l=await c.Z.find(a).sort({createdAt:-1}).limit(50);return i.NextResponse.json({success:!0,data:l},{headers:{"Cache-Control":"public, s-maxage=60, stale-while-revalidate=300"}})}catch(t){console.error("Error fetching content:",t);let e=t instanceof Error?t.message:String(t);return i.NextResponse.json({success:!1,error:"Failed to fetch content",details:e},{status:500})}}async function p(e){try{let t=e.headers.get("x-admin-key");if("TELUGUDB123"!==t)return i.NextResponse.json({success:!1,error:"Unauthorized"},{status:401});await (0,u.Z)();let r=await e.json();if(!r.type||!r.title||!r.poster)return i.NextResponse.json({success:!1,error:"Missing required fields"},{status:400});if("movie"===r.type&&!r.downloadLink)return i.NextResponse.json({success:!1,error:"Download link is required for movies"},{status:400});if("series"===r.type){if(!r.seasons||0===r.seasons.length)return i.NextResponse.json({success:!1,error:"At least one season is required for series"},{status:400});for(let e of r.seasons){if(!e.episodes||0===e.episodes.length)return i.NextResponse.json({success:!1,error:"Each season must have at least one episode"},{status:400});for(let t of e.episodes)if(!t.downloadLink)return i.NextResponse.json({success:!1,error:"Each episode must have a download link"},{status:400})}}let n=await c.Z.create(r);return i.NextResponse.json({success:!0,data:n,message:"Content created successfully"},{status:201})}catch(e){return console.error("Error creating content:",e),i.NextResponse.json({success:!1,error:"Failed to create content"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/content/route",pathname:"/api/content",filename:"route",bundlePath:"app/api/content/route"},resolvedPagePath:"D:\\downloads\\WatchDB Streaming Platform\\telugudb\\src\\app\\api\\content\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:y}=d,f="/api/content/route";function h(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:m})}},4184:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(1185),s=r.n(n);let o="mongodb+srv://Balujeswanth:Baluflix123@cluster0.hqqoxgl.mongodb.net/baluflix?retryWrites=true&w=majority";if(!o)throw Error("Please define the MONGODB_URI environment variable");let a=global.mongoose;a||(a=global.mongoose={conn:null,promise:null});let i=async function(){if(a.conn)return a.conn;a.promise||(a.promise=s().connect(o,{bufferCommands:!1}).then(e=>e));try{a.conn=await a.promise}catch(e){throw a.promise=null,console.error("MongoDB connection error:",e),e}return a.conn}},1150:(e,t,r)=>{r.d(t,{Z:()=>u});var n=r(1185),s=r.n(n);let o=new n.Schema({episodeNumber:{type:Number,required:!0},episodeTitle:{type:String,required:!0},embedIframeLink:{type:String},downloadLink:{type:String,required:!0},quality:{type:String}}),a=new n.Schema({seasonNumber:{type:Number,required:!0},episodes:[o]}),i=new n.Schema({type:{type:String,required:!0,enum:["movie","series"]},title:{type:String,required:!0},poster:{type:String,required:!0},banner:{type:String},description:{type:String},year:{type:String},language:{type:String},category:{type:String},quality:{type:String},rating:{type:Number},tags:[{type:String}],embedIframeLink:{type:String},downloadLink:{type:String},seasons:[a]},{timestamps:!0}),u=s().models.Content||s().model("Content",i)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972],()=>r(9623));module.exports=n})();